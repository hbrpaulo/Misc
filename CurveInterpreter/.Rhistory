trends_interpretations <- function(TrendTests, alpha = 0.05) {
list2env(SeasonMetrics, envir=environment())
cat("\n\nPara identificar a presença de uma tendência nos dados, utilizamos o teste",
"KW-R", "que verifica se os dados apresentam um padrão de crescimento ou declínio ao longo do tempo. Foram analisadas três seções dos dados: tendência global, no início, no meio e no final do período analisado.
Os resultados são descritos abaixo:")
cat("\n\n**Tendência Global:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$global$pvalue),
"\n- Direção: ", results$metrics$trend$global$direction)
cat("\n\nA análise global sugere uma tendência ",
results$metrics$trend$global$direction, ",
com um p-valor de ", results$metrics$trend$global$pvalue,
". Isso indica que",
ifelse(results$metrics$trend$global$pvalue<alpha, "há", "não há"),
"presença de uma tendência significativa ao longo de todo o período.")
cat("\n\n**Tendência no Início:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$begin$pvalue),
"\n- Direção: ", results$metrics$trend$begin$direction)
cat("\n\nNo início do período, os dados apresentam uma tendência ",
results$metrics$trend$begin$direction,
" com um p-valor de ",
results$metrics$trend$begin$pvalue,
". Este valor sugere que",
ifelse(results$metrics$trend$begin$pvalue<alpha, "há", "não há"),
"evidência significativa de uma tendência nesta fase inicial.")
cat("\n\n**Tendência no Meio:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$middle$pvalue),
"\n- Direção: ", results$metrics$trend$middle$direction)
cat("\n\nNa seção central, os resultados indicam uma tendência",
results$metrics$trend$middle$direction,
"com um p-valor de",
results$metrics$trend$middle$pvalue,
". Esse resultado ",
ifelse(results$metrics$trend$middle$pvalue<=alpha, 'aponta', 'não aponta'),
" para a presença de uma tendência significativa nesta parte dos dados.")
cat("\n\n**Tendência no Final**:\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$end$pvalue),
"\n- Direção: ", results$metrics$trend$end$direction)
cat("\n\nNo final do período, observamos uma tendência ",
results$metrics$trend$end$direction,
", com um p-valor de ",
results$metrics$trend$end$pvalue,
". Esses resultados ",
ifelse(results$metrics$trend$end$pvalue<=alpha, 'indicam', 'não indicam'),
" uma mudança significativa na tendência nesta fase.")
}
trends_interpretations(TrendTests, alpha = 0.05)
trends_interpretations <- function(TrendMetrics, alpha = 0.05) {
list2env(TrendMetrics, envir=environment())
cat("\n\nPara identificar a presença de uma tendência nos dados, utilizamos o teste",
"KW-R", "que verifica se os dados apresentam um padrão de crescimento ou declínio ao longo do tempo. Foram analisadas três seções dos dados: tendência global, no início, no meio e no final do período analisado.
Os resultados são descritos abaixo:")
cat("\n\n**Tendência Global:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$global$pvalue),
"\n- Direção: ", results$metrics$trend$global$direction)
cat("\n\nA análise global sugere uma tendência ",
results$metrics$trend$global$direction, ",
com um p-valor de ", results$metrics$trend$global$pvalue,
". Isso indica que",
ifelse(results$metrics$trend$global$pvalue<alpha, "há", "não há"),
"presença de uma tendência significativa ao longo de todo o período.")
cat("\n\n**Tendência no Início:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$begin$pvalue),
"\n- Direção: ", results$metrics$trend$begin$direction)
cat("\n\nNo início do período, os dados apresentam uma tendência ",
results$metrics$trend$begin$direction,
" com um p-valor de ",
results$metrics$trend$begin$pvalue,
". Este valor sugere que",
ifelse(results$metrics$trend$begin$pvalue<alpha, "há", "não há"),
"evidência significativa de uma tendência nesta fase inicial.")
cat("\n\n**Tendência no Meio:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$middle$pvalue),
"\n- Direção: ", results$metrics$trend$middle$direction)
cat("\n\nNa seção central, os resultados indicam uma tendência",
results$metrics$trend$middle$direction,
"com um p-valor de",
results$metrics$trend$middle$pvalue,
". Esse resultado ",
ifelse(results$metrics$trend$middle$pvalue<=alpha, 'aponta', 'não aponta'),
" para a presença de uma tendência significativa nesta parte dos dados.")
cat("\n\n**Tendência no Final**:\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$end$pvalue),
"\n- Direção: ", results$metrics$trend$end$direction)
cat("\n\nNo final do período, observamos uma tendência ",
results$metrics$trend$end$direction,
", com um p-valor de ",
results$metrics$trend$end$pvalue,
". Esses resultados ",
ifelse(results$metrics$trend$end$pvalue<=alpha, 'indicam', 'não indicam'),
" uma mudança significativa na tendência nesta fase.")
}
trends_interpretations(TrendTests, alpha = 0.05)
trends_interpretations <- function(TrendMetrics, alpha = 0.05) {
list2env(TrendMetrics, envir=environment())
cat("\n\nPara identificar a presença de uma tendência nos dados, utilizamos o teste",
"KW-R", "que verifica se os dados apresentam um padrão de crescimento ou declínio ao longo do tempo. Foram analisadas três seções dos dados: tendência global, no início, no meio e no final do período analisado.
Os resultados são descritos abaixo:")
cat("\n\n**Tendência Global:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$global$pvalue),
"\n- Direção: ", results$metrics$trend$global$direction)
cat("\n\nA análise global sugere uma tendência ",
results$metrics$trend$global$direction, ",
com um p-valor de ", results$metrics$trend$global$pvalue,
". Isso indica que",
ifelse(results$metrics$trend$global$pvalue<alpha, "há", "não há"),
"presença de uma tendência significativa ao longo de todo o período.")
cat("\n\n**Tendência no Início:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$begin$pvalue),
"\n- Direção: ", results$metrics$trend$begin$direction)
cat("\n\nNo início do período, os dados apresentam uma tendência ",
results$metrics$trend$begin$direction,
" com um p-valor de ",
results$metrics$trend$begin$pvalue,
". Este valor sugere que",
ifelse(results$metrics$trend$begin$pvalue<alpha, "há", "não há"),
"evidência significativa de uma tendência nesta fase inicial.")
cat("\n\n**Tendência no Meio:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$middle$pvalue),
"\n- Direção: ", results$metrics$trend$middle$direction)
cat("\n\nNa seção central, os resultados indicam uma tendência",
results$metrics$trend$middle$direction,
"com um p-valor de",
results$metrics$trend$middle$pvalue,
". Esse resultado ",
ifelse(results$metrics$trend$middle$pvalue<=alpha, 'aponta', 'não aponta'),
" para a presença de uma tendência significativa nesta parte dos dados.")
cat("\n\n**Tendência no Final**:\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$end$pvalue),
"\n- Direção: ", results$metrics$trend$end$direction)
cat("\n\nNo final do período, observamos uma tendência ",
results$metrics$trend$end$direction,
", com um p-valor de ",
results$metrics$trend$end$pvalue,
". Esses resultados ",
ifelse(results$metrics$trend$end$pvalue<=alpha, 'indicam', 'não indicam'),
" uma mudança significativa na tendência nesta fase.")
}
trends_interpretations(TrendTests, alpha = 0.05)
results$noref
results
results$noref$metrics$trends <- trend_test(database, column = 'data_series')
results$noref$metrics$trends
trends_interpretations(results$noref$metrics$trends, alpha = 0.05)
trends_interpretations <- function(TrendMetrics, alpha = alpha_global) {
list2env(TrendMetrics, envir=environment())
cat("\n\nPara identificar a presença de uma tendência nos dados, utilizamos o teste",
"KW-R", "que verifica se os dados apresentam um padrão de crescimento ou declínio ao longo do tempo. Foram analisadas três seções dos dados: tendência global, no início, no meio e no final do período analisado.
Os resultados são descritos abaixo:")
cat("\n\n**Tendência Global:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$global$pvalue),
"\n- Direção: ", results$metrics$trend$global$direction)
cat("\n\nA análise global sugere uma tendência ",
results$metrics$trend$global$direction, ",
com um p-valor de ", results$metrics$trend$global$pvalue,
". Isso indica que",
ifelse(results$metrics$trend$global$pvalue<alpha, "há", "não há"),
"presença de uma tendência significativa ao longo de todo o período.")
cat("\n\n**Tendência no Início:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$begin$pvalue),
"\n- Direção: ", results$metrics$trend$begin$direction)
cat("\n\nNo início do período, os dados apresentam uma tendência ",
results$metrics$trend$begin$direction,
" com um p-valor de ",
results$metrics$trend$begin$pvalue,
". Este valor sugere que",
ifelse(results$metrics$trend$begin$pvalue<alpha, "há", "não há"),
"evidência significativa de uma tendência nesta fase inicial.")
cat("\n\n**Tendência no Meio:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$middle$pvalue),
"\n- Direção: ", results$metrics$trend$middle$direction)
cat("\n\nNa seção central, os resultados indicam uma tendência",
results$metrics$trend$middle$direction,
"com um p-valor de",
results$metrics$trend$middle$pvalue,
". Esse resultado ",
ifelse(results$metrics$trend$middle$pvalue<=alpha, 'aponta', 'não aponta'),
" para a presença de uma tendência significativa nesta parte dos dados.")
cat("\n\n**Tendência no Final**:\n\n")
cat("- p-valor: ", format_sig(results$metrics$trend$end$pvalue),
"\n- Direção: ", results$metrics$trend$end$direction)
cat("\n\nNo final do período, observamos uma tendência ",
results$metrics$trend$end$direction,
", com um p-valor de ",
results$metrics$trend$end$pvalue,
". Esses resultados ",
ifelse(results$metrics$trend$end$pvalue<=alpha, 'indicam', 'não indicam'),
" uma mudança significativa na tendência nesta fase.")
}
trends_interpretations(results$noref$metrics$trends)
list2env(results$noref$metrics$trends, envir=environment())
cat("\n\nPara identificar a presença de uma tendência nos dados, utilizamos o teste",
"KW-R", "que verifica se os dados apresentam um padrão de crescimento ou declínio ao longo do tempo. Foram analisadas três seções dos dados: tendência global, no início, no meio e no final do período analisado.
Os resultados são descritos abaixo:")
cat("- p-valor: ", format_sig(results$metrics$trend$global$pvalue),
"\n- Direção: ", results$metrics$trend$global$direction)
results$metrics$trends$global$pvalue
results$metrics$trends
results$metrics
results
results$noref$metrics$trends
list2env(results$noref$metrics$trends, envir=environment())
cat("\n\nPara identificar a presença de uma tendência nos dados, utilizamos o teste",
"KW-R", "que verifica se os dados apresentam um padrão de crescimento ou declínio ao longo do tempo. Foram analisadas três seções dos dados: tendência global, no início, no meio e no final do período analisado.
Os resultados são descritos abaixo:")
cat("\n\n**Tendência Global:**\n\n")
cat("- p-valor: ", format_sig(results$metrics$trends$global$pvalue),
"\n- Direção: ", results$metrics$trends$global$direction)
format_sig(global$pvalue)
trends_interpretations <- function(TrendMetrics, alpha = alpha_global) {
list2env(TrendMetrics, envir=environment())
#list2env(results$noref$metrics$trends, envir=environment())
cat("\n\nPara identificar a presença de uma tendência nos dados, utilizamos o teste",
"KW-R", "que verifica se os dados apresentam um padrão de crescimento ou declínio ao longo do tempo. Foram analisadas três seções dos dados: tendência global, no início, no meio e no final do período analisado.
Os resultados são descritos abaixo:")
cat("\n\n**Tendência Global:**\n\n")
cat("- p-valor: ", format_sig(global$pvalue),
"\n- Direção: ", global$direction)
cat("\n\nA análise global sugere uma tendência ",
global$direction, ",
com um p-valor de ", global$pvalue,
". Isso indica que",
ifelse(global$pvalue<alpha, "há", "não há"),
"presença de uma tendência significativa ao longo de todo o período.")
cat("\n\n**Tendência no Início:**\n\n")
cat("- p-valor: ", format_sig(begin$pvalue),
"\n- Direção: ", begin$direction)
cat("\n\nNo início do período, os dados apresentam uma tendência ",
begin$direction,
" com um p-valor de ",
begin$pvalue,
". Este valor sugere que",
ifelse(begin$pvalue<alpha, "há", "não há"),
"evidência significativa de uma tendência nesta fase inicial.")
cat("\n\n**Tendência no Meio:**\n\n")
cat("- p-valor: ", format_sig(middle$pvalue),
"\n- Direção: ", middle$direction)
cat("\n\nNa seção central, os resultados indicam uma tendência",
middle$direction,
"com um p-valor de",
middle$pvalue,
". Esse resultado ",
ifelse(middle$pvalue<=alpha, 'aponta', 'não aponta'),
" para a presença de uma tendência significativa nesta parte dos dados.")
cat("\n\n**Tendência no Final**:\n\n")
cat("- p-valor: ", format_sig(end$pvalue),
"\n- Direção: ", end$direction)
cat("\n\nNo final do período, observamos uma tendência ",
end$direction,
", com um p-valor de ",
end$pvalue,
". Esses resultados ",
ifelse(end$pvalue<=alpha, 'indicam', 'não indicam'),
" uma mudança significativa na tendência nesta fase.")
}
trends_interpretations(results$noref$metrics$trends)
# Chunk 1: setup
knitr::opts_chunk$set(echo = FALSE,
warning = FALSE,
message = FALSE,
knitr.svg.object = TRUE,
out.width='50%',
fig.align = 'center'
)
options(digits = 2)
set.seed(13796163)
# Chunk 2
set.seed(13796163)
library(tidyverse)
library(DiagrammeR)
library(knitr)
library(kableExtra)
# library(janitor)
# library(seastests)
# library(DiagrammeR)
# library(prettydoc)
# library(aTSA)
alpha_global <- alpha <- .05
results <- list()
theme_set(theme_classic())
if(!exists('DocumentType')){
DocumentType <- 1
}
# Chunk 3: cronograma
source('Misc/diagrama.R')
diagram
# Chunk 4
source('https://raw.githubusercontent.com/hbrpaulo/Misc/refs/heads/main/format_sig.R')
source('Misc/example_creation.R')
source('scripts/distances_calculator.R')
source('scripts/fragmentation.R')
database <- fragmentation(distances_calculator(example1))
graph <- 'none'
source('scripts/IntervalMainPlot.R')
source('scripts/tests/trends_test.R')
results$noref$metrics$trends <- trend_test(database, column = 'data_series')
source('scripts/tests/seasonalities_test.R')
results$noref$metrics$seasonalities <- seasonality_tests(database, column = 'data_series')
# Plot the variance against frequencies, color-coded by group
plot(
results$noref$metrics$seasonalities$season_possibilities_all$freq,
xlab = 'Frequency',
results$noref$metrics$seasonalities$season_possibilities_all$vars,
ylab = "Within Variance",
type = "l",
main = str_wrap("Variance Between Cycles for Each Frequency", width = 35)
)
points(
x = results$noref$metrics$seasonalities$season_possibilities_all$freq,
y = results$noref$metrics$seasonalities$season_possibilities_all$vars,
col = results$noref$metrics$seasonalities$season_possibilities_all$group,
pch = 19
)
# Plot the p-values of the seasonality test for each frequency
plot(
x = 7:(length(database$data_series) / 3),
y = sapply(7:(length(
database$data_series
) / 3),
function(f) {
seastests::kw(ts(database$data_series,
frequency = f), freq = f)$Pval
}),
type = "o",
pch = 19,
ylab = "P-value",
xlab = 'Frequency',
main = str_wrap("P-value of the Seasonality test KW for Each Frequency", width = 35)
)
graph <- 'none'
source('scripts/IntervalMainPlot.R')
source('scripts/tests/trends_test.R')
source('scripts/interpretations/trends_interpretations.R')
results$noref$metrics$trends <- trend_test(database, column = 'data_series')
source('scripts/tests/seasonalities_test.R')
results$noref$metrics$seasonalities <- seasonality_tests(database, column = 'data_series')
# Plot the variance against frequencies, color-coded by group
plot(
results$noref$metrics$seasonalities$season_possibilities_all$freq,
xlab = 'Frequency',
results$noref$metrics$seasonalities$season_possibilities_all$vars,
ylab = "Within Variance",
type = "l",
main = str_wrap("Variance Between Cycles for Each Frequency", width = 35)
)
points(
x = results$noref$metrics$seasonalities$season_possibilities_all$freq,
y = results$noref$metrics$seasonalities$season_possibilities_all$vars,
col = results$noref$metrics$seasonalities$season_possibilities_all$group,
pch = 19
)
# Plot the p-values of the seasonality test for each frequency
plot(
x = 7:(length(database$data_series) / 3),
y = sapply(7:(length(
database$data_series
) / 3),
function(f) {
seastests::kw(ts(database$data_series,
frequency = f), freq = f)$Pval
}),
type = "o",
pch = 19,
ylab = "P-value",
xlab = 'Frequency',
main = str_wrap("P-value of the Seasonality test KW for Each Frequency", width = 35)
)
source('scripts/interpretations/seasonalities_interpretations.R')
seasonalities_interpretations(results$noref$metrics$seasonalities)
source('scripts/tests/fragments_comparison_test.R')
results$noref$metrics$frag_comparison <- frag_comparison(database, column = 'data_series')
results$noref$metrics$frag_comparison$partdiff_tb
results$noref$metrics$frag_comparison$partdiff_plot
database <- fragmentation(distances_calculator(example1))
graph <- 'punctual'
source('scripts/IntervalMainPlot.R')
database <- database %>%
mutate(data_series = difference_ref_data)
source('scripts/tests/trends_test.R')
source('scripts/tests/seasonalities_test.R')
source('scripts/interpretations/trends_interpretations.R')
source('scripts/interpretations/trends_interpretations.R')
results$noref$metrics$trends <- trend_test(database, column = 'data_series')
trends_interpretations(results$noref$metrics$trends)
source('scripts/tests/trends_test.R')
results$punctual$metrics$trends <- trend_test(database, column = 'difference_ref_data')
# Chunk 1: setup
knitr::opts_chunk$set(echo = FALSE,
warning = FALSE,
message = FALSE,
knitr.svg.object = TRUE,
out.width='50%',
fig.align = 'center'
)
options(digits = 2)
set.seed(13796163)
# Chunk 2
set.seed(13796163)
library(tidyverse)
library(DiagrammeR)
library(knitr)
library(kableExtra)
# library(janitor)
# library(seastests)
# library(DiagrammeR)
# library(prettydoc)
# library(aTSA)
alpha_global <- alpha <- .05
results <- list()
theme_set(theme_classic())
if(!exists('DocumentType')){
DocumentType <- 1
}
# Chunk 3: cronograma
source('Misc/diagrama.R')
diagram
# Chunk 4
source('https://raw.githubusercontent.com/hbrpaulo/Misc/refs/heads/main/format_sig.R')
source('Misc/example_creation.R')
source('scripts/distances_calculator.R')
source('scripts/fragmentation.R')
database <- fragmentation(distances_calculator(example1))
# Plot the p-values of the seasonality test for each frequency
plot(
x = 7:(length(database$data_series) / 3),
y = sapply(7:(length(
database$data_series
) / 3),
function(f) {
seastests::kw(ts(database$data_series,
frequency = f), freq = f)$Pval
}),
type = "o",
pch = 19,
ylab = "P-value",
xlab = 'Frequency',
main = str_wrap("P-value of the Seasonality test KW for Each Frequency", width = 35)
)
seasonalities_interpretations <- function(SeasonMetrics, alpha = alpha_global){
list2env(SeasonMetrics, envir=environment())
# Graficos ----
# Plot the variance against frequencies, color-coded by group
plot(
season_possibilities_all$freq,
xlab = 'Frequency',
season_possibilities_all$vars,
ylab = "Within Variance",
type = "l",
main = str_wrap("Variance Between Cycles for Each Frequency", width = 35)
)
points(
x = season_possibilities_all$freq,
y = season_possibilities_all$vars,
col = season_possibilities_all$group,
pch = 19
)
# Plot the p-values of the seasonality test for each frequency
plot(
x = 7:(length(database$data_series) / 3),
y = sapply(7:(length(
database$data_series
) / 3),
function(f) {
seastests::kw(ts(database$data_series,
frequency = f), freq = f)$Pval
}),
type = "o",
pch = 19,
ylab = "P-value",
xlab = 'Frequency',
main = str_wrap("P-value of the Seasonality test KW for Each Frequency", width = 35)
)
# Demais analises ----
season_significance <- season_possibilities %>%
select(freq, significance) %>%
group_by(significance) %>%
summarise(signif_equivalents = paste(freq, collapse = ', '))
season_group_possibilities <- season_possibilities %>%
group_by(significance) %>%
summarise(freq = paste(freq, collapse = ', '),
pvalue = max(pvalue))
Saz_No <- paste0('- A(s) frequência(s) de ',
season_group_possibilities$freq,
' apresentaram um p-valor indicativo de ',
str_to_lower(season_group_possibilities$significance))
p_saz_interpret <- ifelse(
season_group_possibilities$pvalue<=alpha,
', o que sugere que há evidências de que essa frequência seja sazonal.',
', o que sugere que não há evidências de que essa frequência seja sazonal.'
)
cat('\n')
if(season_possibilities %>% nrow() == 0){
cat('Sem sazonalidade encontrada na análise'); cat('\n')
} else {
freqs <- paste(season_possibilities$freq, collapse = ', ')
cat('\n\n**Caso haja sazonalidade, as principais suspeitam seriam nas possibilidades a seguir:**', freqs)
cat(season_possibilities %>%
select(-has_equivalence, -significance) %>%
mutate(pvalue = format_sig(pvalue)) %>%
kbl(align = 'ccc',
col.names = c('Frequência', 'Variância', 'Teste', 'Valor de P')) %>%
kable_classic %>%
kable_styling(full_width = FALSE))
cat('\n\nCom base nos resultados obtidos, observamos que:\n\n')
for(i in Saz_No){
cat(i);cat('\n')}
}
}
seasonalities_interpretations()
seasonalities_interpretations(results$noref$metrics$seasonalities)
results$noref$metrics$seasonalities <- seasonality_tests(database, column = 'data_series')
source('scripts/interpretations/seasonalities_interpretations.R')
seasonalities_interpretations(results$noref$metrics$seasonalities)
